###############################################################################
# Nuage Utility Host VM
#
# Configuration for Nuage Utility Host VM.
#
# Automatically generated by {{ generator_script | default("script") }}.
#

{% if nuhs is defined and nuhs %}
{% for item in nuhs %}
#
# NUH {{ loop.index }}
#
-
    ##### Host and VM Name

    # < Hostname >
    # Hostname of the Nuage Utility Host instance
    #
    hostname: "{{ item.hostname }}"

    # < VM name >
    # Name of the Virtual Machine on the Hypervisor
    #
    {%- if item.vmname is defined %}
    vmname: "{{ item.vmname }}"
    {%- else %}
    # vmname: (Hostname)
    {%- endif %}

    ######################

    # < Upgrade VM Name >
    # Virtual Machine name of the new NUH. Used during Upgrade only
    #
    {%- if item.upgrade_vmname is defined %}
    upgrade_vmname: "{{ item.upgrade_vmname }}"
    {%- else %}
    # upgrade_vmname: ""
    {%- endif %}

    ##### Management Interface

    # < Management IP address >
    # IP address of the management interface
    #
    mgmt_ip: "{{ item.mgmt_ip }}"

    # < Management IP Prefix Length >
    # IP Prefix length for the management network
    #
    mgmt_ip_prefix: {{ item.mgmt_ip_prefix }}

    # < Management Gateway IP >
    # IP address of the gateway on the management network
    #
    mgmt_gateway: "{{ item.mgmt_gateway }}"

    ##########################

    ##### Network Interfaces

    # < Internal Network IP address >
    # IP address of the internal network interface. Used for VSD connection when configured
    #
    {%- if item.internal_ip is defined %}
    internal_ip: "{{ item.internal_ip }}"
    {%- else %}
    # internal_ip: ""
    {%- endif %}

    # < Internal Network IP Prefix Length >
    # IP Prefix length for the internal network
    #
    {%- if item.internal_ip_prefix is defined %}
    internal_ip_prefix: {{ item.internal_ip_prefix }}
    {%- else %}
    # internal_ip_prefix: 0
    {%- endif %}

    # < Internal Network Gateway IP >
    # IP address of the gateway on the internal network
    #
    {%- if item.internal_gateway is defined %}
    internal_gateway: "{{ item.internal_gateway }}"
    {%- else %}
    # internal_gateway: ""
    {%- endif %}

    # < External interface name list >
    # Name of the external interface as defined in the nuh_internal_interface file
    #
    {%- if item.external_interface_list is defined %}
    external_interface_list: [ {% for i in item.external_interface_list | default([]) %}"{{ i }}", {% endfor %}]
    {%- else %}
    # external_interface_list: []
    {%- endif %}

    ########################

    ##### Other parameters

    # < Target Server IP or FQDN >
    # Hostname or IP address of the KVM hypervisor where the NUH VM will be instantiated
    #
    target_server: "{{ item.target_server }}"

    # < Target Server Type >
    # Type of hypervisor environment where VMs will be instantiated. Use 'none' when skipping predeploy.
    # (kvm, vcenter, openstack, none) 
    #
    {%- if item.target_server_type is defined %}
    target_server_type: "{{ item.target_server_type }}"
    {%- else %}
    # target_server_type: kvm
    {%- endif %}

    # < Timezone >
    # Timezone of the NUH
    #
    {%- if item.timezone is defined %}
    timezone: "{{ item.timezone }}"
    {%- else %}
    # timezone: America/Toronto
    {%- endif %}

    # < Custom NUH configuration file location >
    # Optional user specified location of the yaml based configuration file for the NUH. This will replace the default yaml configuration file added by MetroAE
    #
    {%- if item.custom_configuration_file_location is defined %}
    custom_configuration_file_location: "{{ item.custom_configuration_file_location }}"
    {%- else %}
    # custom_configuration_file_location: ""
    {%- endif %}

    # < Skip VSD installed check >
    # Enable this option to install NUH in situations where no VSD is present
    #
    {%- if item.skip_vsd_installed_check is defined %}
    skip_vsd_installed_check: {{ item.skip_vsd_installed_check | lower }}
    {%- else %}
    # skip_vsd_installed_check: False
    {%- endif %}

    # < Health monitoring agent >
    # Enables setup of a health monitoring agent
    # (none, zabbix) 
    #
    {%- if item.health_monitoring_agent is defined %}
    health_monitoring_agent: "{{ item.health_monitoring_agent }}"
    {%- else %}
    # health_monitoring_agent: none
    {%- endif %}

    # < KVM cpuset information >
    # Cpuset information for cpu pinning on KVM. For example, NUH requires 4 cores and sample values will be of the form [ 0, 1, 2, 3 ]
    #
    {%- if item.cpuset is defined %}
    cpuset: [ {% for i in item.cpuset | default([]) %}{{ i }}, {% endfor %}]
    {%- else %}
    # cpuset: []
    {%- endif %}

    ######################

    ##### Bridge details

    # < Management Network Bridge >
    # Network Bridge used for the management interface on the NUH. This will be a Linux network bridge when deploying on KVM. Defaults to the global setting
    #
    {%- if item.mgmt_bridge is defined %}
    mgmt_bridge: "{{ item.mgmt_bridge }}"
    {%- else %}
    # mgmt_bridge: (global Bridge interface)
    {%- endif %}

    # < Internal Network Bridge >
    # Network Bridge used for the internal network on the NUH. This will be a Linux network bridge when deploying on KVM. Defaults to using management bridge
    #
    {%- if item.internal_bridge is defined %}
    internal_bridge: "{{ item.internal_bridge }}"
    {%- else %}
    # internal_bridge: (management bridge)
    {%- endif %}

    ####################

    {%- if show_target_server_type | default('vcenter') == 'vcenter' %}

    ##### vCenter Parameters

    # < vCenter Datacenter Name >
    # Name of the vCenter Datacenter on which the VSD VM will be deployed. Defaults to the common vCenter Datacenter Name if not defined here.
    #
    {%- if item.vcenter_datacenter is defined %}
    vcenter_datacenter: "{{ item.vcenter_datacenter }}"
    {%- else %}
    # vcenter_datacenter: (global vCenter Datacenter Name)
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('vcenter') == 'vcenter' %}

    # < vCenter Cluster Name >
    # Name of the vCenter Cluster on which the VSD VM will be deployed. Defaults to the common vCenter Cluster Name if not defined here.
    #
    {%- if item.vcenter_cluster is defined %}
    vcenter_cluster: "{{ item.vcenter_cluster }}"
    {%- else %}
    # vcenter_cluster: (global vCenter Cluster Name)
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('vcenter') == 'vcenter' %}

    # < vCenter Datastore Name >
    # Name of the vCenter Datastore on which the VSD VM will be deployed. Defaults to the common vCenter Datastore Name if not defined here.
    #
    {%- if item.vcenter_datastore is defined %}
    vcenter_datastore: "{{ item.vcenter_datastore }}"
    {%- else %}
    # vcenter_datastore: (global vCenter Datastore Name)
    {%- endif %}

    ########################
    {%- endif %}

    # < Preserve NUH VM >
    # Shuts down the vm during destroy process, instead of actually deleting them.
    #
    {%- if item.preserve_vm is defined %}
    preserve_vm: {{ item.preserve_vm | lower }}
    {%- else %}
    # preserve_vm: true/false
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    ##### OpenStack Parameters

    # < OpenStack Image >
    # Name of image installed on OpenStack for NUH
    #
    {%- if item.openstack_image is defined %}
    openstack_image: "{{ item.openstack_image }}"
    {%- else %}
    # openstack_image: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Flavor >
    # Name of instance flavor installed on OpenStack for NUH
    #
    {%- if item.openstack_flavor is defined %}
    openstack_flavor: "{{ item.openstack_flavor }}"
    {%- else %}
    # openstack_flavor: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Availability Zone >
    # Name of availability zone on OpenStack for NUH
    #
    {%- if item.openstack_availability_zone is defined %}
    openstack_availability_zone: "{{ item.openstack_availability_zone }}"
    {%- else %}
    # openstack_availability_zone: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Network >
    # Name of network on OpenStack for NUH
    #
    {%- if item.openstack_network is defined %}
    openstack_network: "{{ item.openstack_network }}"
    {%- else %}
    # openstack_network: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Subnet >
    # Name of subnet on OpenStack for NUH
    #
    {%- if item.openstack_subnet is defined %}
    openstack_subnet: "{{ item.openstack_subnet }}"
    {%- else %}
    # openstack_subnet: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Port Name >
    # Name for Mgmt interface
    #
    {%- if item.openstack_mgmt_port_name is defined %}
    openstack_mgmt_port_name: "{{ item.openstack_mgmt_port_name }}"
    {%- else %}
    # openstack_mgmt_port_name: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Port Security Groups >
    # Set of security groups to associate with Mgmt interface
    #
    {%- if item.openstack_mgmt_port_security_groups is defined %}
    openstack_mgmt_port_security_groups: [ {% for i in item.openstack_mgmt_port_security_groups | default([]) %}"{{ i }}", {% endfor %}]
    {%- else %}
    # openstack_mgmt_port_security_groups: []
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Port Name >
    # Name for Mgmt interface
    #
    {%- if item.openstack_internal_port_name is defined %}
    openstack_internal_port_name: "{{ item.openstack_internal_port_name }}"
    {%- else %}
    # openstack_internal_port_name: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Port Security Groups >
    # Set of security groups to associate with Mgmt interface
    #
    {%- if item.openstack_internal_port_security_groups is defined %}
    openstack_internal_port_security_groups: [ {% for i in item.openstack_internal_port_security_groups | default([]) %}"{{ i }}", {% endfor %}]
    {%- else %}
    # openstack_internal_port_security_groups: []
    {%- endif %}

    ##########################
    {%- endif %}

    # < VSD FQDN >
    # FQDN of the VSD or VSD cluster
    #
    {%- if item.vsd_fqdn is defined %}
    vsd_fqdn: "{{ item.vsd_fqdn }}"
    {%- else %}
    # vsd_fqdn: ""
    {%- endif %}

{% endfor %}
{% else %}
[ ]
{% endif %}
