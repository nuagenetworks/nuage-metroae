###############################################################################
# Nuage Utility Host VM
#
# Configuration for Nuage Utility Host VM.
#
# Automatically generated by {{ generator_script | default("script") }}.
#

{% if nuhs is defined and nuhs %}
{% for item in nuhs %}
#
# NUH {{ loop.index }}
#
-
    ##### Management Interface

    # < Hostname >
    # Hostname of the Nuage Utility Host instance
    #
    hostname: "{{ item.hostname }}"

    # < Management IP address >
    # IP address of the management interface
    #
    mgmt_ip: "{{ item.mgmt_ip }}"

    # < Management IP Prefix Length >
    # IP Prefix length for the management network
    #
    mgmt_ip_prefix: {{ item.mgmt_ip_prefix }}

    # < Management Gateway IP >
    # IP address of the gateway on the management network
    #
    mgmt_gateway: "{{ item.mgmt_gateway }}"

    ##########################

    ##### Network Interfaces

    # < Internal Network IP address >
    # IP address of the internal network interface. Used for VSD connection when configured
    #
    {%- if item.internal_ip is defined %}
    internal_ip: "{{ item.internal_ip }}"
    {%- else %}
    # internal_ip: ""
    {%- endif %}

    # < Internal Network IP Prefix Length >
    # IP Prefix length for the internal network
    #
    {%- if item.internal_ip_prefix is defined %}
    internal_ip_prefix: {{ item.internal_ip_prefix }}
    {%- else %}
    # internal_ip_prefix: ""
    {%- endif %}

    # < Internal Network Gateway IP >
    # IP address of the gateway on the internal network
    #
    {%- if item.internal_gateway is defined %}
    internal_gateway: "{{ item.internal_gateway }}"
    {%- else %}
    # internal_gateway: ""
    {%- endif %}

    # < External interface name list >
    # Name of the external interface as defined in the nuh_internal_interface file
    #
    {%- if item.external_interface_list is defined %}
    external_interface_list: [ {% for i in item.external_interface_list | default([]) %}"{{ i }}", {% endfor %}]
    {%- else %}
    # external_interface_list: []
    {%- endif %}

    ########################

    ##### Other parameters

    # < Target Server IP or FQDN >
    # Hostname or IP address of the KVM hypervisor where the DNS VM will be instantiated
    #
    target_server: "{{ item.target_server }}"

    # < Timezone >
    # Timezone of the NUH
    #
    {%- if item.timezone is defined %}
    timezone: "{{ item.timezone }}"
    {%- else %}
    # timezone: America/Toronto
    {%- endif %}

    # < Health monitoring agent >
    # Enables setup of a health monitoring agent
    # (none, zabbix) 
    #
    {%- if item.health_monitoring_agent is defined %}
    health_monitoring_agent: "{{ item.health_monitoring_agent }}"
    {%- else %}
    # health_monitoring_agent: none
    {%- endif %}

    # < KVM cpuset information >
    # Cpuset information for cpu pinning on KVM. For example, NUH requires 4 cores and sample values will be of the form [ 0, 1, 2, 3 ]
    #
    {%- if item.cpuset is defined %}
    cpuset: [ {% for i in item.cpuset | default([]) %}{{ i }}, {% endfor %}]
    {%- else %}
    # cpuset: []
    {%- endif %}

    ######################

    ##### Bridge details

    # < Management Network Bridge >
    # Network Bridge used for the management interface on the NUH. This will be a Linux network bridge when deploying on KVM. Defaults to the global setting
    #
    {%- if item.mgmt_bridge is defined %}
    mgmt_bridge: "{{ item.mgmt_bridge }}"
    {%- else %}
    # mgmt_bridge: (global Bridge interface)
    {%- endif %}

    # < Internal Network Bridge >
    # Network Bridge used for the internal network on the NUH. This will be a Linux network bridge when deploying on KVM. Defaults to using management bridge
    #
    {%- if item.internal_bridge is defined %}
    internal_bridge: "{{ item.internal_bridge }}"
    {%- else %}
    # internal_bridge: (management bridge)
    {%- endif %}

    ####################

{% endfor %}
{% else %}
[ ]
{% endif %}
