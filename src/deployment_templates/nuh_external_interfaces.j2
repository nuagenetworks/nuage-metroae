###############################################################################
# Nuage Utility Host External Interfaces List
#
# Configuration for external interfaces for NUH
#
# Automatically generated by {{ generator_script | default("script") }}.
#

{% if nuh_external_interfaces is defined and nuh_external_interfaces %}
{% for item in nuh_external_interfaces %}
#
# ExternalInterface {{ loop.index }}
#
-
    ##### External Network

    # < NUH external network name >
    # Name of the external network for NUH
    #
    name: "{{ item.name }}"

    # < External Network dev >
    # Dev for the external network
    #
    {%- if item.dev is defined %}
    dev: {{ item.dev }}
    {%- else %}
    # dev: 0
    {%- endif %}

    # < External Network IP address >
    # IP address of the external network interface. This network is the one where NSGs reside
    #
    external_ip: "{{ item.external_ip }}"

    # < Peer's External Network IP address >
    # IP address of the external network interface of NUH peer. This network is the one where NSGs reside
    #
    {%- if item.external_peer_ip is defined %}
    external_peer_ip: "{{ item.external_peer_ip }}"
    {%- else %}
    # external_peer_ip: ""
    {%- endif %}

    # < External Network IP Prefix Length >
    # IP Prefix length for the external network
    #
    {%- if item.external_ip_prefix is defined %}
    external_ip_prefix: {{ item.external_ip_prefix }}
    {%- else %}
    # external_ip_prefix: 0
    {%- endif %}

    # < External Network Gateway IP >
    # IP address of the gateway on the external network
    #
    external_gateway: "{{ item.external_gateway }}"

    # < External Network VLAN ID >
    # Optional VLAN ID for external network. Must be unique per external interface. If unspecified, VLAN is unassigned and only one external interface can be used
    #
    {%- if item.vlan is defined %}
    vlan: {{ item.vlan }}
    {%- else %}
    # vlan: 100
    {%- endif %}

    # < External FQDN Name >
    # Optional External FQDN name. A valid cert of this FQDN will be generated from the VSD and transferred to NUH
    #
    external_fqdn: "{{ item.external_fqdn }}"

    # < Peer's External FQDN Name >
    # Optional External FQDN name of NUH peer. A valid cert of this FQDN will be generated from the VSD and transferred to NUH
    #
    {%- if item.external_peer_fqdn is defined %}
    external_peer_fqdn: "{{ item.external_peer_fqdn }}"
    {%- else %}
    # external_peer_fqdn: ""
    {%- endif %}

    # < External Network Bridge >
    # Network Bridge used for the external network on the NUH. This will be a Linux network bridge when deploying on KVM. Defaults to using access bridge
    #
    {%- if item.external_bridge is defined %}
    external_bridge: "{{ item.external_bridge }}"
    {%- else %}
    # external_bridge: (access bridge)
    {%- endif %}

    # < Distributed vSwitch Name >
    # Name of the distrubuted vSwitch. Required to identify correct distributed portgroup, if there are multiple of the same name.
    #
    {%- if item.dvswitch_name is defined %}
    dvswitch_name: "{{ item.dvswitch_name }}"
    {%- else %}
    # dvswitch_name: ""
    {%- endif %}

    ######################

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    ##### OpenStack Parameters

    # < OpenStack External Network >
    # Name of external network on OpenStack for NUH
    #
    {%- if item.openstack_external_network is defined %}
    openstack_external_network: "{{ item.openstack_external_network }}"
    {%- else %}
    # openstack_external_network: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack External Subnet >
    # Name of external subnet on OpenStack for NUH
    #
    {%- if item.openstack_external_subnet is defined %}
    openstack_external_subnet: "{{ item.openstack_external_subnet }}"
    {%- else %}
    # openstack_external_subnet: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack external Port Name >
    # Name for external interface
    #
    {%- if item.openstack_external_port_name is defined %}
    openstack_external_port_name: "{{ item.openstack_external_port_name }}"
    {%- else %}
    # openstack_external_port_name: ""
    {%- endif %}
    {%- endif %}

    {%- if show_target_server_type | default('openstack') == 'openstack' %}

    # < OpenStack Port Security Groups >
    # Set of security groups to associate with external interface
    #
    {%- if item.openstack_external_port_security_groups is defined %}
    openstack_external_port_security_groups: [ {% for i in item.openstack_external_port_security_groups | default([]) %}"{{ i }}", {% endfor %}]
    {%- else %}
    # openstack_external_port_security_groups: []
    {%- endif %}

    ##########################
    {%- endif %}

{% endfor %}
{% else %}
[ ]
{% endif %}
