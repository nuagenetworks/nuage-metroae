---
- block:
  - name: "[check-ovs-service] Check if openvswitch service is running (RedHat)"
    command: systemctl status openvswitch
    ignore_errors: yes
    changed_when: false
    register: service_openvswitch_status
  when: ansible_os_family  == "RedHat"

- block:
  - name: "[check-ovs-service] Check if openvswitch service is running (Ubuntu 14.04)"
    command: service nuage-openvswitch-switch status
    ignore_errors: yes
    changed_when: false
    register: service_openvswitch_status
  when: ansible_distribution == "Ubuntu" and ansible_distribution_version == "14.04"

- name: "[check-ovs-service] Report status of Openvswitch"
  fail:
    msg: |
      Service Openvswitch is not running.
      Output:
      {{ service_openvswitch_status.stdout }}
      {{ service_openvswitch_status.stderr }}
  when: service_openvswitch_status | failed
