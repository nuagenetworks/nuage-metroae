migrate_current_data: "/opt/vsd/stats_collector/bin/es-db-manage --from 4.0.1 --to {{ vsd_version.stdout }} --eshost {{ inventory_hostname }} --currentonly current"
migrate_previous_data: "/opt/vsd/stats_collector/bin/es-db-manage --from 4.0.1 --to {{ vsd_version.stdout }} --eshost {{ inventory_hostname }}"
get_indices: "vsd_elasticctl.py -a {{ mgmt_ip }} list_indices"
restore_snapshot: "vsd_elasticctl.py -a {{ mgmt_ip }} restore_snapshot {{ names.stdout_lines[1]}} -r {{ names.stdout_lines[0] }} -i {{ list_of_indices | default('all') }}"
show_snapshot: "vsd_elasticctl.py -a {{ mgmt_ip }} show_snapshot {{ names.stdout_lines[1] }} -r {{ names.stdout_lines[0] }}"
create_repo: "vsd_elasticctl.py -a {{ mgmt_ip }}  create_repository {{ names.stdout_lines[0] }} -t fs -l {{ vstat_backup_dir }}"
show_repo: "vsd_elasticctl.py -a {{ mgmt_ip }}  show_repository {{ names.stdout_lines[0] }}"
transfer_vstat_scripts: "scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null {{ vstat_backup_scripts_path }}/{{ item }} root@{{ mgmt_ip }}:/tmp/"
transfer_backup_folder: "scp -r -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null {{metro_backup_root}}/backup-{{ groups['vstats'][0] }}-latest/* root@{{ mgmt_ip }}:{{ vstat_backup_dir }}"
vstat_should_become: "{{ 'no' if vstat_username | default(vstat_default_username) == 'root' else 'yes' }}"
