- block:
  - name: Configure yum proxy
    lineinfile:
      dest: /etc/yum.conf
      regexp: "^proxy="
      line: "proxy={{ yum_proxy }}"
    when: yum_proxy is not match('NONE')

  - name: Execute a yum update (Can take 20 minutes)
    yum:
      name: '*'
      state: latest
    when: yum_update
  remote_user: "{{ vsd_default_username }}"
  when: inventory_hostname in groups['vsds']

- block:
  - name: Configure yum proxy
    lineinfile:
      dest: /etc/yum.conf
      regexp: "^proxy="
      line: "proxy={{ yum_proxy }}"
    when: yum_proxy is not match('NONE')

  - name: Execute a yum update for vstat (Can take 20 minutes)
    yum:
      name: '*'
      state: latest
    when: vstat_yum_update
  remote_user: "{{ vstat_default_username }}"
  when: inventory_hostname in groups['vstats']

