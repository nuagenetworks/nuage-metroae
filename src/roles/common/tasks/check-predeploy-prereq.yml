---

- block:

  - name: Check that QCOW2 files were found
    assert:
      that: "qcow2_path is defined and qcow2_file_name is defined"
      msg: "Missing QCOW2 file {{ qcow2_file_name }} for {{ hostname }} under the unzipped file directory {{ qcow2_path }}, please unzip them and issue reset_build"
    when: target_server_type | match("kvm")

  - name: Check that OVA files were found
    assert:
      that: "ova_path is defined and ova_file_name is defined"
      msg: "Missing OVA file {{ ova_file_name }} for {{ hostname }} under the unzipped file directory {{ ova_path }}, please unzip them and issue reset_build"
    when: target_server_type | match("vcenter")

  when: component_type | default("NONE") != 'vrs'

- name: Check that TIM file was found
  assert:
    that: "vsc_tim_path is defined and vsc_tim_file_name is defined"
    msg: "Missing VSC TIM image file {{ vsc_tim_file_name }} for {{ hostname }} under the unzipped file directory {{ vsc_tim_path }}, please unzip it and issue reset_build"
  when: component_type | default("NONE") == 'vsc'

- block:

  - name: Check that VRS package files were found
    assert:
      that: "vrs_package_path is defined and vrs_package_file_name_list is defined"
      msg: "Missing VRS package files under the unzipped file directory {{ vrs_package_path }} , please unzip it and issue reset_build"

  - name: Check that VRS libnetwork files were found
    assert:
      that: "libnetwork_package_path is defined and libnetwork_package_file_name is defined"
      msg: "Missing VRS libnetwork file {{ ilibnetwork_package_file_name }} under the unzipped file directory {{ libnetwork_package_path }} , please unzip it and issue reset_build"
    when: libnetwork_install | default(False)

  - name: Check that DKMS files were found
    assert:
      that: "dkms_package_path is defined and dkms_package_file_name_list is defined"
      msg: "Missing VRS DKMS files under the unzipped file directory {{ dkms_path_path }}, please unzip it and issue reset_build"
    when: dkms_install

  when: component_type | default("NONE") == 'vrs'
