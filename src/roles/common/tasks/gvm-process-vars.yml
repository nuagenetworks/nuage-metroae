- name: Set mygvms

  set_fact: mygvms_check={{ mygvms is defined }}



- name: Assign empty list to mygvms if it is undefined

  set_fact: mygvms= default([])

  when: not mygvms_check



- name: Create host_vars files for gvms

  template: src=gvm.j2 backup=no dest={{ playbook_dir }}/host_vars/{{ item.hostname }}

  with_items: "{{ mygvms }}"

  when: mygvms_check
