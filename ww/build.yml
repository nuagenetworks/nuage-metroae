---
# See BUILD.md for details

# First set of tasks is to gather_facts so that subsequent task list can use these facts as part of variable setting
- hosts: localhost
  gather_facts: yes
  tasks: []

# Actual tasks to generate build configuration
- hosts: localhost
  vars:
    nuage_packed_src_path: "/home/caso/metro/4.0R6/packed"
    nuage_unpacked_dest_path: "/home/caso/metro/4.0R6/unpacked"
    nuage_already_unpacked: false
    nuage_target_architecture: "el7"
    vsd_standalone: True
    myvsdson_install: True
    myvrss:
      vrs_set1:
        vrs_os_type: debian
        active_controller_ip: 192.168.122.202
        standby_controller_ip: 192.168.122.203
        vrs_ip_list: 
        - 10.10.10.2
        - 10.10.10.3
        - 10.10.10.4 
      vrs_set2:
        vrs_os_type: redhat
        active_controller_ip: 192.168.122.202
        standby_controller_ip: 192.168.122.203
        vrs_ip_list: 
        - 10.10.10.5
        - 10.10.10.6
        - 10.10.10.7 
  tasks:

  - name: Create the host_vars directory
    file: path=/home/caso/nuage-metro/ww/host_vars/ state=directory
  - debug:
      msg: "vrs type is : {{ item.value.vrs_os_type}}"
    with_dict:  "{{ myvrss }}"
      #verbosity: 2

  - debug:
      msg: "vrs ip's are : {{ item.1 }}"
    with_subelements:  
      - "{{ myvrss }}"
      - vrs_ip_list

  - name: Create host_vars files for vrs
    template: src=vrs.j2 backup=no dest=/home/caso/nuage-metro/ww/host_vars/{{ item.1 }}
    with_subelements: 
      - "{{ myvrss }}"
      - vrs_ip_list
