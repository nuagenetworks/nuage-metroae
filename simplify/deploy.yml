---

- hosts: localhost
  connection: local
  gather_facts: no
  roles:
    - init
  tags: always

- hosts: servers
  gather_facts: yes
  roles:
    - { role: vm-host, tags: [ 'vsd', 'vsd-predeploy', 'vsc' ] }

- hosts: vsds
  gather_facts: no
  roles:
    - { role: create-vm, tags: [ 'vsd', 'vsd-predeploy' ] }

- hosts: vsds
  serial: 1
  gather_facts: no
  roles:
    - { role: vsd, tags: [ 'vsd', 'vsd-install' ] }

- hosts: vscs
  gather_facts: no
  roles:
    - vsc
