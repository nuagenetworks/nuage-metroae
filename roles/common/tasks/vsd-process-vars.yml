---
- name: Set VSD image location
  include_tasks: 
    vsd-find-image.yml

- name: Set myvsds_check
  set_fact: myvsds_check={{myvsds is defined}}

- name: Assign empty list to myvsds if it is undefined
  set_fact: myvsds= default([])
  when: not myvsds_check

- block:
  - name: Verify that vsd_fqdn_globl is defined
    assert:
      that:
        - "vsd_fqdn_global is defined"
      msg: "vsd_fqdn_global must be defined. See build_vars.yml."

  - name: Create host_vars files for vsd
    template: src=vsd.j2 backup=no dest={{ inventory_dir }}/host_vars/{{ item.hostname }}
    with_items: "{{ myvsds }}"
  when: myvsds_check
