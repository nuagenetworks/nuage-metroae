---
- name: Retrieve Host IP
  shell: "getent hosts {{ item.hostname }} | awk '{print $1}'"
  register: hostip
  
- name: Ensuring Host IP from DNS and host_vars is the same
  assert:
    that: "'{{ hostip.stdout }}' ==  '{{ item.mgmt_ip }}'"
    msg: "Querying {{ dns_server_list[0] }} for IPv4 address for {{item.hostname}} != {{item.mgmt_ip}}"

- block:
    - shell: "getent hosts {{ item.data_fqdn }} | awk '{print $1}'"
      register: data_fqdn_ip

    - name: Ensuring Host IP from DNS and host_vars is the same
      assert:
        that: "'{{ data_fqdn_ip.stdout }}' ==  '{{ item.data_ip }}'"
        msg: "Querying {{ dns_server_list[0] }} for IPv4 address for {{item.data_fqdn}} != {{item.data_ip}}"
  when: myvnsutils is defined  
