---
- include: get_paths.yml

- name: Clear host_vars directory
  file: path={{ playbook_dir }}/host_vars/ state=absent
  tags:
    - always

- name: Create the host_vars directory
  file: path={{ playbook_dir }}/host_vars/ state=directory
  tags:
    - always

- name: Update VSD variables
  include_role:
    name: common
    tasks_from: vsd-process-vars

- name: Update VSC variables
  include_role:
    name: common
    tasks_from: vsc-process-vars

- name: Update VSTAT variables
  include_role:
    name: common
    tasks_from: vstat-process-vars

- name: Update VCIN variables
  include_role:
    name: common
    tasks_from: vsd-process-vars

- name: Update VNSUTIL variables
  include_role:
    name: common
    tasks_from: vnsutil-process-vars

- name: Update NSGV variables
  include_role:
    name: common
    tasks_from: nsgv-process-vars

- name: Update VRS variables
  include_role:
    name: common
    tasks_from: vrs-process-vars

- include: infra_build_helper.yml

- include: ci_build_helper.yml

- include: dns_build_helper.yml

- include: gvm_build_helper.yml

- include: osc_build_helper.yml

- include: os_compute_build_helper.yml

- include: vsr_build_helper.yml
  tags:
    - vsr

- name: Create hosts file
  template: src=hosts.j2 dest="{{ playbook_dir }}/hosts" backup=no
  tags:
    - always

- name: Create the group_vars directory
  file: path={{ playbook_dir }}/group_vars/ state=directory
  tags:
    - always

- name: Create group_vars/all file
  template: src=group_vars.all.j2 dest="{{ playbook_dir }}/group_vars/all" backup=no
  tags:
    - always
