---

- name: Check Ansible host prerequisites 
  include_role:
    name: common
    tasks_from: check-prereq-{{ ansible_os_family }}
    tags: check

- include: get_paths.yml

- name: Clear host_vars directory
  file: path={{ playbook_dir }}/host_vars/ state=absent
  tags:
    - always

- name: Create the host_vars directory
  file: path={{ playbook_dir }}/host_vars/ state=directory
  tags:
    - always

- include: vsd_build_helper.yml

- include: vsc_build_helper.yml

- include: vstat_build_helper.yml

- include: vcin_build_helper.yml

- include: vnsutil_build_helper.yml

- include: nsgv_build_helper.yml
  tags:
   - nsgv

- include: vrs_build_helper.yml

- include: infra_build_helper.yml

- include: ci_build_helper.yml

- include: dns_build_helper.yml

- include: gvm_build_helper.yml

- include: osc_build_helper.yml

- include: os_compute_build_helper.yml

- include: vsr_build_helper.yml
  tags:
    - vsr

- name: Create hosts file
  template: src=hosts.j2 dest="{{ playbook_dir }}/hosts" backup=no
  tags:
    - always

- name: Create the group_vars directory
  file: path={{ playbook_dir }}/group_vars/ state=directory
  tags:
    - always
    
- name: Create group_vars/all file
  template: src=group_vars.all.j2 dest="{{ playbook_dir }}/group_vars/all" backup=no
  tags:
    - always
