---
- include: report_header.yml

- block:
  - name: Get current network config of all VSTAT nodes
    network_info:
      mac_addr: False
    register: net_conf
    remote_user: "{{ vstat_username }}"

  - name: Print network config when verbosity >= 1
    debug: var=net_conf.info verbosity=1

  - name: Write network config to json file
    nuage_append: filename="{{ report_path }}" text="{{ net_conf.info | to_nice_json}}\n"
    delegate_to: localhost
  when: inventory_hostname in groups['vstats']

- include: monit_status.yml
  when: inventory_hostname in groups['vsds']

- include: report_footer.yml
